# Metrics Server Helm Values
# Story: 0-3 Kubernetes Cluster Provisioning
# AC: 7 - Metrics server installed for HPA and resource monitoring
# Tasks: 7.1
#
# Chart: metrics-server/metrics-server (~> 3.11)
# Repo: https://kubernetes-sigs.github.io/metrics-server
#
# Install command:
#   helm repo add metrics-server https://kubernetes-sigs.github.io/metrics-server
#   helm install metrics-server metrics-server/metrics-server \
#     -n kube-system \
#     -f values.yaml

replicas: 2

resources:
  requests:
    cpu: 100m
    memory: 200Mi
  limits:
    cpu: 200m
    memory: 400Mi

# Metrics resolution interval
defaultArgs:
  - --cert-dir=/tmp
  - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname
  - --kubelet-use-node-status-port
  - --metric-resolution=15s

# Pod disruption budget for high availability
podDisruptionBudget:
  enabled: true
  maxUnavailable: 1

# Run on general nodes
nodeSelector:
  node-type: general

# Tolerations (none needed - runs on general nodes)
tolerations: []

# Anti-affinity to spread across nodes
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: metrics-server
        topologyKey: kubernetes.io/hostname
