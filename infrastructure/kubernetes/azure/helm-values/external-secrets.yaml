# ExternalSecrets Operator Helm Values — Azure
# QUALISYS Azure Infrastructure
#
# Install:
#   helm repo add external-secrets https://charts.external-secrets.io
#   helm install external-secrets external-secrets/external-secrets \
#     -n external-secrets --create-namespace \
#     -f kubernetes/azure/helm-values/external-secrets.yaml

replicaCount: 2

serviceAccount:
  create: true
  name: external-secrets-sa
  annotations:
    # Workload Identity annotation — replace with Terraform output
    azure.workload.identity/client-id: "<EXTERNAL_SECRETS_CLIENT_ID>"
  labels:
    azure.workload.identity/use: "true"

# Webhook for validation of ExternalSecret resources
webhook:
  replicaCount: 2

# Cert controller for webhook TLS
certController:
  replicaCount: 1

# Resource limits
resources:
  requests:
    cpu: 50m
    memory: 128Mi
  limits:
    cpu: 200m
    memory: 256Mi

# Pod security context (compatible with PSS restricted)
securityContext:
  runAsNonRoot: true
  runAsUser: 65534
  fsGroup: 65534

# Tolerations (run on general nodes)
tolerations: []

# Node selector
nodeSelector:
  node-type: general

# Priority class for reliability
priorityClassName: system-cluster-critical
